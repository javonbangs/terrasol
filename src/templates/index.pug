extends partials/_layout
append head 
    +header({
        "type": "home",
        "title": "Terrasol", 
        "metadescription": "Smart-Homes.", 
        "img": "https://veridium.io/images/logo_square.png", 
        "url": "http://www.veridium.io",
        "ld": { 
            "@context": "http://schema.org",
            "@type": "WebSite",  
            "url": "https://www.veridium.io/"
        }
    }) 
block vars 
  - var type = 'index' 
block content 
    section#hero  
        #hero-svg
            include ./assets/house.svg  
        .container
            hgroup
                h1 Smart-Homes Powered by Neural Networks and Machine Learning.
                p Terrasol provides businesses and home-owners with machine learning technology. Partnered with utility, security and IoT companies we help provide you with smoother home atmospheres.
                .btn-group
                    a(href="#")
                        button.secondary.iconed-rt
                            div
                                span Learn more
                                .icon-telegram
                    button.tri(data-modal-button="#typeform")
                        div
                            span Products  
    section#desc
        #hero-svg-2
            include ./assets/river.svg
        .container
            hgroup.parent-slider#someslider 
                h1 Meet Terrasol.   
                p Terrasol is making lives easier at the home and office, utilizing algorithms and Neural Networks pioneered by Professor Geoffrey Hinton. Terrasol is self-sustaining and can be yours today.
            #desc-art
                include ./assets/brain.svg            
    section.parent-slider#resources(data-index="0")
        #resources-bg-wrap
            include ./assets/bg.svg
        .container 
            #resources-svg
                include ./assets/peter.svg
            #some-parent
                ul.clickables#resources-btns
                    li
                    li
                    li
                .scrollable#resources-scroll
                    hgroup#resources-hgroup
                        h1 Life, Automated.
                        p Peter, a busy salesman, has a problem. He loses money and sleep with a home climate control system that is obsolete. He always finds himself rushing home to tinker with the thermostat.
                        p Now, using Terrasol's technology he can control it from anywhere. The neural network will start to learn Peter's patterns and do it for him when he forgets.
                    hgroup#resources-hgroup
                    hgroup#resources-hgroup
                button.secondary.iconed-rt(data-clickable="1")
                    div
                        span Next
                        div.icon-chevron-right


    script.
        window.addEventListener('DOMContentLoaded', function () {

            var isSafari = navigator.vendor && navigator.vendor.indexOf('Apple') > -1 &&
                    navigator.userAgent && !navigator.userAgent.match('CriOS') &&
                    !navigator.userAgent.match('FxiOS');

            if (isSafari) {
                var s = document.createElement('style')
                s.innerHTML = `[filter]{filter: none!important}[style*='filter:'] {filter: none!important};`
                document.head.append(s)
            }

            setTimeout(function() {

                document.body.classList.toggle('do')

                setTimeout(function () {
                    document.body.classList.toggle('do')
                }, 4000)

            }, 4000);

            _doResize()

            var yo = document.querySelector('#yo')
            yo.addEventListener('click', function() {
                document.body.classList.toggle('do')
            })

            var main = document.querySelector('main')

            var _close = function (el) { 

                el.classList.add('hidden')
                document.documentElement.classList.remove('noscroll')

            }

            var _open = function (el) {

                el.classList.remove('hidden')
                document.documentElement.classList.add('noscroll')

            }
        
            Array.prototype.slice.call(document.querySelectorAll('[data-modal-button]')).forEach(function (el) {

                el.addEventListener('click', function (ev) {


                    if (!el.dataset.modalButton) throw new Error('closed button that didn\'t have close data-open attr')
                    var openEl = document.querySelector(el.dataset.modalButton)
                    if (!openEl) throw new Error('no closable element found. selector in data-open is not valid')
                    _open(openEl)

                })

            })

            Array.prototype.slice.call(document.querySelectorAll('.modal-close-btn')).forEach(function (el) {

                el.addEventListener('click', function (ev) {

                    if (!el.dataset.close) throw new Error('closed button that didn\'t have close data-close attr')
                    var closeEl = document.querySelector(el.dataset.close)
                    if (!closeEl) throw new Error('no closable element found. selector in data-close is not valid')
                    _close(closeEl)

                })

            })

            Array.prototype.slice.call(document.querySelectorAll('.modal')).forEach(function (el) {

                el.addEventListener('click', function (ev) {

                    if (ev.target === el)
                        _close(el)

                })

            })

            var mobileTrigger = document.querySelector('#mobile-trigger')

            mobileTrigger.addEventListener('click', function (ev) {
                
                var open = main.dataset.showNav
                main.dataset.showNav = open === 'true' ? false : true

            })
            window.addEventListener('click', function (ev) {

                var mobileTrigger = document.querySelector('#mobile-trigger')
                if (mobileTrigger.contains(ev.target)) return 
                
                main.dataset.showNav = 'false'

            })

            if (window.location.pathname == '/thank-you')
                document.querySelector('#confirmation').classList.remove('hidden')

            Array.prototype.slice.call(document.querySelectorAll('.arrow-left')).forEach(function (el) {

                el.addEventListener('click', function (_el) {

                    var parent = el.closest('.parent-slider')
                    var l = Array.prototype.slice.call(parent.querySelector('.scrollable').children).length
                    var index = parent.dataset.index === '0' ? l - 1 : (parseInt(parent.dataset.index) - 1);
                    goToSlide('#' + parent.id, index)

                })

            })

            Array.prototype.slice.call(document.querySelectorAll('.arrow-right, [data-clickable]')).forEach(function (el) {

                el.addEventListener('click', function (_el) {

                    var parent = el.closest('.parent-slider')
                    var l = Array.prototype.slice.call(parent.querySelector('.scrollable').children).length
                    if (el.dataset.clickable) {
                        var index = parseInt(parent.dataset.index) + parseInt(el.dataset.clickable)
                        if (l <= index) index = 0
                    } else
                        var index = parent.dataset.index.toString() === (l - 1).toString() ? 0 : (parseInt(parent.dataset.index) + 1);
                    goToSlide('#' + parent.id, index)

                })

            })

            Array.prototype.slice.call(document.querySelectorAll('.clickables')).forEach(function(el) {

                var parent = el.closest('.parent-slider')
                Array.prototype.slice.call(el.children).forEach(function(_el, index) {

                    _el.addEventListener('click', function(ev) {

                        goToSlide('#' + parent.id, index)

                    })
                    
                })

            })

        })

        function goToSlide(parentId, index, slideBy) {

            var parent = document.querySelector(parentId)
            parent.dataset.index = index
            Array.prototype.slice.call(parent.querySelectorAll(parentId + ' .scrollable')).forEach(function (el) {
                
                // var slideAmount = slideBy ? : index;
                
                var width = el.getBoundingClientRect().width
                el.scrollLeft = (index * width)

            })

        }


        var _doResize = function () {

        }

        window.addEventListener('resize', _doResize)
            